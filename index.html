<!DOCTYPE html>

<html>
    <head>
        <title>Biodivine/Aeon</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="style.css" type="text/css">        

        <script src="script/dependencies/cytoscape.min.js"></script>
        <script src="script/dependencies/lodash.js"></script>
        <script src="script/dependencies/cytoscape-edgehandles.js"></script>
        <script src="script/dependencies/hotkeys.min.js"></script>

        <script src="script/ComputeEngine.js"></script>
        <script src="script/LiveModel.js"></script>
        <script src="script/UI.js"></script>
        <script src="script/CytoscapeEditor.js"></script>        
        <script src="script/ModelEditor.js"></script>        
        <script src="script/main.js"></script>
    </head>

    <body onload="init()">

        <!-- Hosts the interactive model editor -->        
        <div id="cytoscape-editor">
        </div>


        <div id="quick-help">
            <h3 style="display: block; margin: 0 auto; float: right;">HELP</h3>
            <b>Network editor actions:</b>
            <ul>
                <li>Double click to create a new variable.</li>
                <li>Drag from `+` to create a new regulation.</li>
                <li>Select element (click) to show the context menu.</li>
            </ul>
            <b>Keyboard shortcuts:</b>
            <ul>
                <li>(⌫) Remove selected element.</li>
                <li>(N) Add new variable.</li>
                <li>(E) Edit name of the selected variable.</li>
                <li>(F) Edit update function of the selected variable.</li>
                <li>(O) Change observability of the selected regulation.</li>
                <li>(M) Change monotonicity of the selected regulation.</li>
                <li>(H) Show this help message.</li>                
            </ul>
            <div style="width: 100%; text-align: center; font-size: 12px;">(this message disappears when you create the first variable)</div>            
        </div>

        <!-- A menu element that is shown for selected graph nodes in the editor. -->
        <div id="node-menu" class="float-menu invisible">
            <div class="button-row">                
                <img alt="Edit name (E)" id="node-menu-edit-name" class="button" src="img/edit-24px.svg">                
                <img alt="Edit update function (F)" id="node-menu-edit-function" class="button" src="img/functions-24px.svg">
                <img alt="Remove (⌫)" id="node-menu-remove" class="button" src="img/delete-24px.svg">
            </div>
            <br>
            <span class="hint invisible">Hint</span>
        </div>

        <!-- A menu element which is shown for selected edges in the editor. -->
        <div id="edge-menu" class="float-menu invisible">
            <div class="button-row">                
                <img alt="Toggle observability (O)" id="edge-menu-observability" class="button" src="img/visibility_off-24px.svg" 
                    src-on="img/visibility_off-24px.svg" src-off="img/visibility_on-24px.svg" 
                    alt-on="Observability off (O)" alt-off="Observability on (O)" 
                    state=""
                >
                <img alt="Toggle monotonicity (M)" id="edge-menu-monotonicity" class="button" src="img/trending_up-24px.svg"
                    src-unspecified="img/trending_up-24px.svg" alt-unspecified="Make activating (M)"
                    src-activation="img/trending_down-24px.svg" alt-activation="Make inhibiting (M)"
                    src-inhibition="img/swap_vert-24px.svg" alt-inhibition="Monotonicity off (M)"
                    state=""
                >
                <img alt="Remove (⌫)" id="edge-menu-remove" class="button" src="img/delete-24px.svg">
            </div>
            <br>
            <span class="hint invisible">Hint</span>
        </div>

        <div style="position: absolute;">            

            <div id="tab-model-editor" class="main-panel gone" style="padding-bottom: 0px;">
                <div class="invisible-input full-line">
                    <input id="model-name" class="center" type="text" name="model-name" placeholder="(model name)" style="font-size: 20px;">
                </div>
                <img alt="close" src="img/close-24px.svg" class="panel-close-button" onclick="UI.closeContent()">                
                <div class="invisible-input full-line" id="model-description" contenteditable data-placeholder="(model description)" style="margin-top: 4px; margin-bottom: 4px;"></div>      

                <div style="height: 30px;">
                    <h3 style="font-family: 'FiraMono'; text-transform: uppercase;"> ● Overview</h3>
                </div>
                <table id="model-stats">
                    <tr class="row">    <td>Variables: </td>        <td class="value">XY</td>     <td>Parameter space size: </td>  <td class="value">XY</td> </tr>
                    <tr class="row">    <td>Regulations: </td>      <td class="value">XY</td>     <td>Transition graph size: </td> <td class="value">XY</td> </tr>
                    <tr class="row">    <td>Max. in-degree: </td>   <td class="value">XY</td>     <td>Max. out-degree: </td>       <td class="value">XY</td> </tr>
                    <tr class="row">    <td colspan="2">Explicit parameters: </td>  <td colspan="2">a, b, c, </td>   </tr>
                </table>                   
                <div style="height: 40px;">
                    <h3 style="float: left; font-family: 'FiraMono'; text-transform: uppercase;"> ● Variables</h3>
                    <button id="button-add-variable" class="image-button" onclick="let id = LiveModel.addVariable(); CytoscapeEditor.showNode(id);" style="float: right;">Add variable (N) <img src="img/add_box-24px.svg"></button>
                </div>
                <div style="clear: both;"></div>
                <div id="model-variables" class="full-line">                                    
                </div>                       
                <div class="templates gone">
                    <div id="model-variable-template" class="model-variable">
                        <div class="invisible-input">
                            <input class="variable-name" type="text" name="variable-name" value="Variable name" placeholder="(variable name)" style="font-size: 18px;" spellcheck='false' autocorrect='off'>
                        </div>
                        <img alt="Remove variable" src="img/delete-24px.svg" class="model-variable-remove button">
                        <img alt="Show variable" src="img/search-24px.svg" class="model-variable-show button">
                        <br>
                        <h4> ● Regulators</h4>
                        <div class="model-variable-regulators full-line"></div>
                        <h4> ● Update Function</h4>
                        <div class="invisible-input full-line variable-function" contenteditable data-placeholder="(default)" spellcheck='false' autocorrect='off' style="font-size: 16px; text-align: center;"></div>
                        <div class="variable-function-status"></div>
                    </div>

                    <div id="model-regulation-template" class="model-regulation">
                        <span class="model-regulation-regulator">Some name</span>
                        <span class="model-regulation-short">(->)</span>
                        <span class="model-regulation-observable">observable</span>
                        <span class="model-regulation-monotonicity">activation</span>
                    </div>                    
                </div>
            </div>

            <div id="tab-engine" class="main-panel gone">
                <img alt="close" src="img/close-24px.svg" class="panel-close-button" onclick="UI.closeContent()">
                <h2 style="margin: 0 auto; font-size: 20px; text-align: center;">Compute Engine</h2>                
                <div class="invisible-input full-line" style="margin-top: 4px; margin-bottom: 4px; font-size: 16px;">
                    <input id="engine-address" class="center" type="text" name="engine-address" value="http://localhost:8000" placeholder="(engine address)">
                </div>
                <div style="height: 40px;">
                    <h3 id="compute-engine-status" style="float: left; font-family: 'FiraMono'; text-transform: uppercase;"> ● Disconnected</h3>
                    <button id="button-connect" class="image-button" onclick="ComputeEngine.toggleConnection((e,r) => { if (e !== undefined) alert(e); });" style="float: right;">Connect <img src="img/cloud-24px.svg"></button>
                </div>
                <div style="clear: both;"></div>
                <div style="text-align: center;">
                    <h3 style="margin: 0 auto; font-size: 14px; text-align: center; margin-bottom: 4px;">No engine running? Download binary:</h3>                    
                    <button id="download-windows" class="image-button" style="display: inline-block; margin: 4px;">Windows <img src="img/windows-24px.svg"></button>
                    <button id="download-windows" class="image-button" style="display: inline-block; margin: 4px;">MacOS <img src="img/macos-24px.svg"></button>
                    <button id="download-windows" class="image-button" style="display: inline-block; margin: 4px;">Linux <img src="img/linux-24px.svg"></button>
                </div>                
            </div>

            <div id="tab-import-export" class="main-panel gone">
                <img alt="close" src="img/close-24px.svg" class="panel-close-button" onclick="UI.closeContent()">
                <h2 style="margin: 0 auto; font-size: 20px; text-align: center; margin-bottom: 8px;">Model File</h2>

                <div style="width: 244px; display: block; float: left; margin-right: 6px;">
                    <h3 style="display: block; margin: 0 auto; text-align: center; margin-top: 8px; margin-bottom: 8px;">Import</h3>

                    <button id="import-local" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;" onclick="LiveModel.loadFromLocalStorage();"><span class="main">local<br>storage</span><span class="desc">Last loaded model</span></button>

                    <label for="import-aeon-input" id="import-aeon" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;"><span class="main">.AEON</span><span class="desc">Simple text format</span></label>                    

                    <button id="import-sbml" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;"><span class="main">.SBML</span><span class="desc">Popular XML format</span></button>

                    <input onchange='UI.importAeon(this)' id='import-aeon-input' style='display:none' type='file'>
                </div>
                <div style="width: 244px; display: inline-block; margin-left: 6px; float: right;">
                    <h3 style="display: block; margin: 0 auto; text-align: center; margin-top: 8px; margin-bottom: 8px;">Export</h3>

                    <button id="export-aeon" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;" onclick="UI.downloadAeon();"><span class="main">Export .aeon</span><span class="desc">Simple text format</span></button>

                    <button id="export-sbml" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;"><span class="main">Export SBML<br><small>(parametrized)</small></span><span class="desc">Parametric extension</span></button>

                    <button id="export-sbml" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;"><span class="main">Export SBML<br><small>(instantiated)</small></span><span class="desc">Instantiated parameters</span></button>                   
                </div>                
                <div style="clear: both;"></div>   
                <h3 style="display: block; margin: 0 auto; text-align: center; margin-top: 8px; margin-bottom: 8px;">Example Models</h3>  

                <button id="example-1" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;"><span class="main">Model 1</span><span class="desc">5 variables</span></button>         
                <button id="example-2" class="compound-button" style="margin-top: 8px; margin-bottom: 8px; float: right;"><span class="main">Model 1</span><span class="desc">5 variables</span></button>
                <button id="example-2" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;"><span class="main">Model 1</span><span class="desc">5 variables</span></button>
                <button id="example-3" class="compound-button" style="margin-top: 8px; margin-bottom: 8px; float: right;"><span class="main">Model 1</span><span class="desc">5 variables</span></button>
                <button id="example-4" class="compound-button" style="margin-top: 8px; margin-bottom: 8px;"><span class="main">Model 1</span><span class="desc">5 variables</span></button>
                <button id="example-5" class="compound-button" style="margin-top: 8px; margin-bottom: 8px; float: right;"><span class="main">Model 1</span><span class="desc">5 variables</span></button>
                <div style="clear: both;"></div>   
            </div>

            <div id="side-menu">
                <div class="button-group">
                    <img alt="Engine" id="side-menu-engine" src="img/engine-48px.svg" class="button" tab-id="tab-engine">
                    <span id="engine-dot">●</span>
                    <span class="hint invisible">Compute Engine</span>
                </div>

                <div class="button-group">
                    <img alt="Import/Export" id="side-menu-import-export" src="img/file_copy-48px.svg" class="button" tab-id="tab-import-export">
                    <span class="hint invisible">Import/Export</span>
                </div> 

                <div class="button-group">
                    <img alt="Model" id="side-menu-model" src="img/model-48px.svg" class="button" tab-id="tab-model-editor">
                    <span class="hint invisible">Model Editor</span>
                </div>  

            </div>
        </div>

    </body>
</html>
